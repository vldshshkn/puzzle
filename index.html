
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>ðŸŽ‰ Ð¡Ð¾Ð±ÐµÑ€Ð¸ Ð¿Ð°Ð·Ð»!</title>
    <style>
        body {
            background: #fff0f6;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-family: sans-serif;
        }
        h2 {
            color: #222;
        }
        #puzzle {
            width: 400px;
            height: 400px;
            display: flex;
            flex-wrap: wrap;
            border: 5px solid hotpink;
        }
        .piece {
            width: 100px;
            height: 100px;
            background-image: url("dog_focused_puzzle.jpg");
            background-size: 400px 400px;
            box-sizing: border-box;
            border: 1px solid #fff;
        }
    </style>
</head>
<body>
    <h2>ðŸ§© Ð¡Ð¾Ð±ÐµÑ€Ð¸ Ð¿Ð°Ð·Ð»!</h2>
    <div id="puzzle"></div>
    <p id="message" style="font-size:18px; margin-top:20px;"></p>
    <script>
        console.log("ðŸ§ª Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ Ð¾Ñ‚Ð»Ð°Ð´ÐºÐ¸ Ð·Ð°Ð³Ñ€ÑƒÐ¶ÐµÐ½");

        const puzzle = document.getElementById('puzzle');
        const message = document.getElementById('message');

        let pieces = [];
        const size = 100;

        for (let y = 0; y < 4; y++) {
            for (let x = 0; x < 4; x++) {
                const div = document.createElement('div');
                div.className = 'piece';
                div.dataset.correctX = x * -size;
                div.dataset.correctY = y * -size;
                div.style.backgroundPosition = `${x * -size}px ${y * -size}px`;
                pieces.push(div);
            }
        }

        // ÐŸÐµÑ€ÐµÐ¼ÐµÑˆÐ¸Ð²Ð°Ð½Ð¸Ðµ
        pieces.sort(() => Math.random() - 0.5);

        // Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð² DOM
        pieces.forEach(piece => puzzle.appendChild(piece));

        // Ð¡Ð¼ÐµÐ½Ð° Ð¼ÐµÑÑ‚Ð°Ð¼Ð¸
        let first = null;
        puzzle.addEventListener('click', e => {
            if (!e.target.classList.contains('piece')) return;
            if (!first) {
                first = e.target;
                first.style.outline = "2px solid red";
            } else {
                const second = e.target;
                [first.style.backgroundPosition, second.style.backgroundPosition] =
                    [second.style.backgroundPosition, first.style.backgroundPosition];
                first.style.outline = "none";
                first = null;
                checkWin();
            }
        });

        function parsePosition(pos) {
            const [x, y] = pos.split(' ').map(v => parseInt(v));
            return { x, y };
        }

        function checkWin() {
            let win = true;
            [...puzzle.children].forEach((div, i) => {
                const correctX = parseInt(div.dataset.correctX);
                const correctY = parseInt(div.dataset.correctY);
                const { x, y } = parsePosition(div.style.backgroundPosition);
                if (x !== correctX || y !== correctY) {
                    console.log(`âŒ ÐšÑƒÑÐ¾Ðº ${i}: ÐžÐ–Ð˜Ð”ÐÐ›ÐžÐ¡Ð¬: ${correctX}px ${correctY}px, Ð Ð•Ð¡Ð¢Ð¬: ${x}px ${y}px`);
                    win = false;
                } else {
                    console.log(`âœ… ÐšÑƒÑÐ¾Ðº ${i}: ${x}px ${y}px`);
                }
            });

            console.log("ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ°: ", win);
            if (win) {
                message.textContent = "ðŸŽ‰ ÐœÐ¾Ð»Ð¾Ð´ÐµÑ†!";
                setTimeout(() => {
                    window.location.href = "https://lera-birthday.tilda.ws/win";
                }, 1000);
            }
        }
    </script>
</body>
</html>
